<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minha Lista</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.jquery.min.js"></script>
    <link href="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link rel = "stylesheet" href = "static/css/style.css">
</head>
<body>
    
    <div class="wrapper">
        <!-- Acesso ao Index e visualização do logo da IMDbSearch -->
        <div class="header">
            <div class="container">
                <img src="static/image/ImdbSearch.png">
                <a href="index.html" class="procurar-filmes"><i class="fa-solid fa-magnifying-glass"></i><b>Procurar</b></a>
            </div>
        </div>

        <!-- Container do título -->
        <div class="container-minha-lista">
            <h1><b>Minha Lista</b></h1>
        </div>
        <!-- fim do container do título -->

        <main>

            <div class="container" id="container-botao-abrir">
            <button class="botao-abrir-form" onclick="abrirForm()"><i class="fa-solid fa-filter"></i>Filtrar</button>
            </div>

            <div class="container" id="consulta-minha-lista">
                <form class="form-minha-lista" method="POST" action="/filmes">
                    {{ form.csrf_token }}

                <div class="linha-forma-consulta">
                    <p>
                        {{ form.formaConsulta.label }}
                        {{ form.formaConsulta() }}
                    </p>

                {% if form.formaConsulta.errors %}
                    <ul class="errors">
                    {% for error in form.formaConsulta.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                    </ul>
                {% endif %}
                </div>

                <div class="linha-ano">
                    <p>
                    {{ form.anoMin.label }}
                    {{ form.anoMin() }}
                    </p>

                    {% if form.anoMin.errors %}
                    <ul class="errors">
                        {% for error in form.anoMin.errors %}
                        <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}

                    <p>
                    {{ form.anoMax.label }}
                    {{ form.anoMax() }}
                    </p>

                    {% if form.anoMax.errors %}
                    <ul class="errors">
                        {% for error in form.anoMax.errors %}
                        <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>

                <div class="linha-duracao">
                    <p>
                    {{ form.duracaoMin.label }}
                    {{ form.duracaoMin() }}
                    </p>

                    {% if form.duracaoMin.errors %}
                    <ul class="errors">
                        {% for error in form.duracaoMin.errors %}
                        <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}

                    <p>
                    {{ form.duracaoMax.label }}
                    {{ form.duracaoMax() }}
                    </p>

                    {% if form.duracaoMax.errors %}
                    <ul class="errors">
                        {% for error in form.duracaoMax.errors %}
                        <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>

                <div class="linha-nota">
                    <p>
                    {{ form.notaMin.label }}
                    {{ form.notaMin() }}
                    </p>

                    {% if form.notaMin.errors %}
                    <ul class="errors">
                        {% for error in form.notaMin.errors %}
                        <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}

                    <p>
                    {{ form.notaMax.label }}
                    {{ form.notaMax() }}
                    </p>

                    {% if form.notaMax.errors %}
                    <ul class="errors">
                        {% for error in form.notaMax.errors %}
                        <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>

                <div class="linha-genero">
                    <p>
                        {{ form.genero.label }}
                        {{ form.genero(class="chosen-select") }}
                    </p>

                {% if form.genero.errors %}
                    <ul class="errors">
                    {% for error in form.genero.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                    </ul>
                {% endif %}
                </div>

                <div class="linha-botao">
                <p>
                    <input type="submit" value="Consultar">
                </p>

                <p>
                    <button type="button" class="botao-cancelar" onclick="fecharForm()">Fechar</button>
                </p>
                </div>

                </form>
            </div>

            <div class="container" id="minha-lista">
                <div id="mostrar-lisa-filmes">
                        {% for message in get_flashed_messages() %}
                             <p class="lista-vazia">{{ message }}</p>
                        {% endfor %}

                    {% if query %}
                            <table class="table-minha-lista">
                            {% for q in query %}
                                <tr>
                                    <td class="table-poster" onclick="window.location='filmes/{{ q[0] }}';" style="cursor: pointer;"><img src="{{ q[6] }}" alt="" border=3 height=150 width=450></img></td>
                                    <td class="table-titulo" onclick="window.location='filmes/{{ q[0] }}';" style="cursor: pointer;">{{ q[1] }}</td>
                                    <td class="ano" onclick="window.location='filmes/{{ q[0] }}';" style="cursor: pointer;">{{ q[2] }}</td>
                                    <td class="table-duracao" onclick="window.location='filmes/{{ q[0] }}';" style="cursor: pointer;">{{ q[3] }} min</td>
                                    <td class="table-genero" onclick="window.location='filmes/{{ q[0] }}';" style="cursor: pointer;">{{ q[4].rstrip(" ") | replace(" ",", ") }}</td>
                                    <td class="table-avaliacao" onclick="window.location='filmes/{{ q[0] }}';" style="cursor: pointer;"><i class="fa-sharp fa-solid fa-star"></i>{{ q[5] }}</td>
                                    <td class="table-botao">
                                        <span id="{{ q[0] }}" class="hide id-filme">{{ q[0] }}</span>
                                        <button class="table-botao-remover" onclick="window.location='remover/{{ q[0] }}'"><i class="fa-solid fa-circle-minus"></i></button>
                                    </td>
                                </tr>
                            {% endfor %}
                            </table>

                    {% endif %}
                </div>
            </div>
        </main>
    </div>


    <script src="../static/js/minhaLista.js"></script>
    <script src="../static/js/chosen.js"></script>
</body>
</html>